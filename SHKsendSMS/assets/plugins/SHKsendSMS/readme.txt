

SHKsendSMS плагин для Shopkeeper >= 0.9.6

Плагин отправляет СМС сообщения покупателю при смене статуса заказа. Покупатель в личном кабинете (SHKUserProfile) может отказаться от получения СМС (используется плагин addWebUserFields).
Для отправки СМС используется сервис http://prostor-sms.ru/. В коде плагина нужно ввести ваши логин и пароль в этом сервисе, а также имя отправителя СМС.
Также в коде плагина есть другие настройки (см. комментарии в коде).

------------------------------------------

Конфигурация:
&status1_tpl=Новый - чанк;string;@FILE:assets/plugins/SHKsendSMS/sms_body.tpl &status2_tpl=Принят к оплате - чанк;string;1 &status3_tpl=Отправлен - чанк;string;1 &status4_tpl=Выполнен - чанк;string;1 &status5_tpl=Отменен - чанк;string;1 &status6_tpl=Оплата получена - чанк;string;1

Системное событие:
OnSHKChangeStatus

------------------------------------------

В поле конфигурации (например "Новый - чанк") можно писать имя чанка или путь до файла с шаблоном для текста СМС. Файл указывается через параметр "@FILE:".

Если в поле конфигурации указано "1", то шаблон будет браться такой же как для первого статуса ("Новый"). Если "2" - шаблон берется из второго поля ("Принят к оплате") и т.д.

Если в поле конфиурации указано "0", то СМС отправляться не будет.

Можно писать имя чанка, путь до файла чанка через команду @FILE: или сразу код чанка через команду @CODE:.

Текс письма переводится в транслит.

------------------------------------------

Доступные плейсхолдеры:

orderID - ID заказа
status_name - статус
site_name - название сайта
site_url - адрес сайта

short_txt - контактная информация
price - общая цена
currency - валюта
date - дата заказа
sentdate - дата отправки заказа
note - заметка
email - адрес эл. почты
phone - телефон
payment - способ оплаты
tracking_num - трекинг номер

------------------------------------------

Настройки сервиса СМС (логин, пароль и т.п.) в коде плагина в самом верху.

$sms_serv_path - адрес сервиса отправки СМС
$sms_serv_protocol - протокол (http)
$sms_serv_login - логин
$sms_serv_password - пароль
$sms_serv_sender - имя отправителя
$sms_testmode = true; - тестовый режим. СМС не будут отправляться, но внизу на странице таблицы заказов будут появляться отладочные сообщения.

$chk_order_string = 'СМС: да'; - строка из оформления заказа (незарегистрированный пользователь), по которой можно опредилить нужно отправлять СМС или нет (см. пример).

$chk_order_user_fieldname = 'sms__checkbox'; - имя доп. поля пользователя с параметром отправки СМС.

